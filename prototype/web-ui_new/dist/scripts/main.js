"use strict";function getUsers(){var e=new XMLHttpRequest;e.open("GET","https://znap.pythonanywhere.com/api/v1.0/web_user/",!1),e.setRequestHeader("Content-Type","application/json"),e.send(),users=JSON.parse(e.response);for(var t=0,s=0;s<users.length;s++){$("#list").append("<tr class='user'><th class='id' scope='row'></th><th class='name'></th><th class='last_name'></th><th class='email'></th><th  class='phone'></th><th class='is_closed'></th><th  class='rate'></th></tr>");var a=users[s].id,n=users[s].first_name,r=users[s].last_name,i=users[s].email,p=users[s].phone,l=!1;if(t+=users[s].rates.length,users[s].rates.length>0)for(var o=0;o<users[s].rates.length;o++)if(users[s].rates[o].is_closed){l=!0;break}$("#list tr:last .id").append(a),$("#list tr:last .name").append(n),$("#list tr:last .last_name").append(r),$("#list tr:last .email").append(i),$("#list tr:last .phone").append(p),l?$("#list tr:last .is_closed").append("No"):$("#list tr:last .is_closed").append("Yes"),users[s].rates.length>0?$("#list tr:last .rate").append(' <button id="dialog-opener" type="button" class="btn btn-primary active ui-button ui-corner-all ui-widget " onClick="openRates('+users[s].id+')">Написати</button>'):$("#list tr:last .rate").append('<button type="button" class ="btn .btn-warning disabled">Немає відгуків</button>')}$("#users_count").text(users.length),$("#rates_count").text(t)}function getUser(e){var t=new XMLHttpRequest;return t.open("GET","https://znap.pythonanywhere.com/api/v1.0/user/"+e+"/",!1),t.setRequestHeader("Content-Type","application/json"),t.send(),JSON.parse(t.response)}function getRate(){var e=new XMLHttpRequest;e.open("GET","https://znap.pythonanywhere.com/api/v1.0/znap/"+znap_id+"/rate/",!1),e.setRequestHeader("Content-Type","application/json"),e.send();for(var t=JSON.parse(e.response),s=t.length-1;s>=0;s--){var a=getUser(t[s].user_id),n=a.first_name,r=a.last_name;a.middle_name;$("#list2").append('<li class="list-group-item" xmlns="http://www.w3.org/1999/html"><div class="row"> <div class="col-md-6"><h4 class="name"></h4><h6 class="description"></h6></div><div class="col-md-6 text-right"><h4 class="quality"></h4><h6 class="time"></h6></div></div></li>'),$("#list2 li:last .name").append(n+" "+r),$("#list2 li:last .quality").append(t[s].quality),$("#list2 li:last .description").append(t[s].description)}}function getAdminRates(){var e=new XMLHttpRequest;e.open("GET","https://znap.pythonanywhere.com/api/v1.0/admin/"+admin_id+"/rate/",!1),e.setRequestHeader("Content-Type","application/json"),e.send();JSON.parse(e.response)}function closeRate(e){var t={is_closed:!0},s=new XMLHttpRequest;s.open("PUT","https://znap.pythonanywhere.com/api/v1.0/rate/"+e+"/",!1),s.setRequestHeader("Content-Type","application/json"),s.send(JSON.stringify(t))}function putAdmin(e,t){var s={admin:e},a=new XMLHttpRequest;a.open("PUT","https://znap.pythonanywhere.com/api/v1.0/rate/"+t+"/",!1),a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify(s))}function openRates(e){for(var t=0;t<users.length;t++)if(users[t].id==e)for(var s=0;s<users[t].rates.length;s++)$("#rates-modal .rates-content").append(users[t].rates[s].toString());$("#wrapper").addClass("blur"),$("#rates-modal").show()}var admin_id=localStorage.getItem("admin_id"),znap_id=localStorage.getItem("znap_id"),users;$("#rates-modal .close").on("click",function(){$(this).closest("#rates-modal").hide(),$("#wrapper").removeClass("blur"),$("#rates-modal .rates-content").empty()});